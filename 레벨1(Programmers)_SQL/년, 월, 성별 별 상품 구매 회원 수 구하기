SELECT
    TO_CHAR(ONLINE_SALE.SALES_DATE,'YYYY') AS YEAR,
    TO_NUMBER(TO_CHAR(ONLINE_SALE.SALES_DATE,'MM')) AS MONTH,
    USER_INFO.GENDER,
    COUNT(DISTINCT USER_INFO.USER_ID) AS USERS
FROM
    USER_INFO 
INNER JOIN 
    ONLINE_SALE 
ON USER_INFO.USER_ID = ONLINE_SALE.USER_ID
WHERE 
   USER_INFO.GENDER IS NOT NULL
GROUP BY TO_CHAR(ONLINE_SALE.SALES_DATE,'YYYY'), TO_NUMBER(TO_CHAR(ONLINE_SALE.SALES_DATE,'MM')), USER_INFO.GENDER
ORDER BY YEAR, MONTH, USER_INFO.GENDER
